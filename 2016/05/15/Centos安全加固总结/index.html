<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="google-site-verification" content="" />
  
  <title>Kelvin&#39;s Blog</title>
  <meta name="author" content="Kelvin">
   <meta name="description" content="Things need record">
  

  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:site_name" content="Kelvin&#39;s Blog"/>
 <meta property="og:image" content="undefined"/>
  
  <link rel="alternate" href="/atom.xml" title="Kelvin&#39;s Blog" type="application/atom+xml">
  <link rel="stylesheet" href="//cdn.bootcss.com/bootstrap/3.3.6/css/bootstrap.min.css">
  <link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.5.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="http://7xs4ih.com1.z0.glb.clouddn.com/plnV5.css">
  <link rel="icon" type="image/x-icon" href="/favicon.ico">
  <script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script>
</head>

<body>
  <div id="main">
    <div class="behind">
      <div class="back">
        <a href="/" class="black-color"><i class="fa fa-times-circle-o"></i></a>
      </div>
      <div class="description">
        &nbsp;Carpe Diem
      </div>
    </div>
    <div class="container">
      

  <article class="standard post">
    <div class="title">
      
  
    <h1 class="page-title center">
        
    </h1>
  


    </div>
    <div class="meta center">
      
<time datetime="2016-05-15T02:13:03.797Z">
  <i class="fa fa-calendar"></i>&nbsp;
  2016-05-15
</time>







    </div>
    <hr>
    <div class="picture-container">
      
    </div>
    <p>#Centos安全加固</p>
<blockquote>
<ul>
<li>要更新的软件：<br>bash，openssl，glibc</li>
</ul>
</blockquote>
<h1 id="1-配置密码不允许重复次数和复杂度"><a href="#1-配置密码不允许重复次数和复杂度" class="headerlink" title="1. 配置密码不允许重复次数和复杂度"></a>1. 配置密码不允许重复次数和复杂度</h1><pre>
#编辑/etc/pam.d/system-auth文件，找到以下行：
password    sufficient    pam_unix.so sha512 shadow nullok try_first_pass use_authtok
#后面添加  remember=3  代表不允许使用之前3次用过的密码
</pre>

<pre>
#找到以下行
password    requisite     pam_cracklib.so try_first_pass retry=3 type=

修改为：
password    requisite     pam_cracklib.so try_first_pass retry=6 ucredit=-1 lcredit=-1 dcredit=-1 ocredit=-1
#retry=N 重试N次后返回密码错误
#difok=N 新密码必需与旧密码不同的位数
#dcredit=N N>=0表示密码最多N个数字，反之最少N个数字
#lcredit=N 小写字母个数
#ucredit=N 小写字母个数
#ccredit=N 小写字母个数
#minclass=N 密码组成(大/小字母,数字,特殊字符)
#root不受此限制，普通用户登录后改密码才受限制
</pre>

<h1 id="2-禁止root登录"><a href="#2-禁止root登录" class="headerlink" title="2. 禁止root登录"></a>2. 禁止root登录</h1><pre>
#更改/etc/ssh/sshd_config，之后重启sshd
PermitRootLogin yes
改成：PermitRootLogin no
</pre>

<h1 id="3-修改密码长度和过期时间："><a href="#3-修改密码长度和过期时间：" class="headerlink" title="3.修改密码长度和过期时间："></a>3.修改密码长度和过期时间：</h1><pre>
#改 /etc/login.defs
PASS_MAX_DAYS   90
PASS_MIN_DAYS   1
PASS_MIN_LEN    9
PASS_WARN_AGE   7
解释：
# PASS_MAX_DAYS   密码使用的最长期限
# PASS_MIN_DAYS   密码允许更改的最短期限
# PASS_MIN_LEN    能接受的密码最短长度
# PASS_WARN_AGE   密码过期之前的提醒天数
</pre>

<h1 id="4-设置连续失败次数和失败锁定时间"><a href="#4-设置连续失败次数和失败锁定时间" class="headerlink" title="4. 设置连续失败次数和失败锁定时间"></a>4. 设置连续失败次数和失败锁定时间</h1><p>修改(/etc/pam.d/system-auth和/etc/pam.d/sshd)分别在开始位置加入以下内容：</p>
<pre>
auth    required    pam_tally2.so    deny=6    unlock_time=300    even_deny_root root_unlock_time=120
#最大失败次数6次，超过6次锁定300s，root用户锁定120s
#两个文件中"required pam_tally2.so deny"要删掉
</pre>

<h1 id="5-umask降权，设置历史命令数"><a href="#5-umask降权，设置历史命令数" class="headerlink" title="5. umask降权，设置历史命令数"></a>5. umask降权，设置历史命令数</h1><p>默认uid&gt;199的umask是022，uid&lt;199的umask是022，可以在/etc/profile里新加一行”umask 027”，修改HISSIZE=100，即最大历史命令是100</p>
<h1 id="6-修改ssh-banner"><a href="#6-修改ssh-banner" class="headerlink" title="6. 修改ssh banner"></a>6. 修改ssh banner</h1><p>自定义banner文件：echo “Only Gomeholdings users can login” &gt; /etc/ssh/gomebanner<br>再修改/etc/ssh/sshd_config 新增”Banner /etc/ssh/gomebanner”</p>
<h1 id="7-修改ssh访问控制"><a href="#7-修改ssh访问控制" class="headerlink" title="7. 修改ssh访问控制"></a>7. 修改ssh访问控制</h1><p>/etc/hosts.allow文件<br>如： sshd:10.35.0.0/255.255.0.0<br>禁止访问的文件 /etc/hosts.deny    sshd:all<br>hosts.allow文件优先</p>
<h1 id="8-空闲超时退出"><a href="#8-空闲超时退出" class="headerlink" title="8. 空闲超时退出"></a>8. 空闲超时退出</h1><p>改/etc/profile 追加 TMOUT=300</p>
<h1 id="9-su限制"><a href="#9-su限制" class="headerlink" title="9. su限制"></a>9. su限制</h1><p>修改/etc/login.defs 追加”SU_WHEEL_ONLY yes”<br>修改/etc/pam.d/su<br>将”auth        required    pam_wheel.so use_uid”取消注释<br>将要配置su权限的用户加到wheel组：<br>usermod -G wheel work</p>
<h1 id="10-取消CTRL-ALT-DELETE"><a href="#10-取消CTRL-ALT-DELETE" class="headerlink" title="10. 取消CTRL+ALT+DELETE"></a>10. 取消CTRL+ALT+DELETE</h1><p>修改/etc/init/control-alt-delete.conf，注释掉以下内容：<br>start on control-alt-delete<br>exec /sbin/shutdown -r now “Control-Alt-Delete pressed”</p>
<p>对于Centos7只需：rm -rf /usr/lib/systemd/ctrl-alt-del.target</p>
<h1 id="11-修改motd，登陆系统后的提示信息"><a href="#11-修改motd，登陆系统后的提示信息" class="headerlink" title="11. 修改motd，登陆系统后的提示信息"></a>11. 修改motd，登陆系统后的提示信息</h1><p>echo “Illegal users are not allowed to login, Only authorized users can login” &gt; /etc/motd<br>当用显示器连接linux主机的时候，屏幕会显示系统版本等相关信息，可以将他取消掉，将/etc/issue和/etc/issue.net改名即可</p>
<h1 id="12-禁用不用的用户和组"><a href="#12-禁用不用的用户和组" class="headerlink" title="12. 禁用不用的用户和组"></a>12. 禁用不用的用户和组</h1><pre>
改/etc/passwd
#adm:x:3:4:adm:/var/adm:/sbin/nologin
#lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin
#sync:x:5:0:sync:/sbin:/bin/sync
#shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown
#halt:x:7:0:halt:/sbin:/sbin/halt
#uucp:x:10:14:uucp:/var/spool/uucp:/sbin/nologin
#operator:x:11:0:operator:/root:/sbin/nologin
#games:x:12:100:games:/usr/games:/sbin/nologin
#gopher:x:13:30:gopher:/var/gopher:/sbin/nologin
</pre>

<pre>
改/etc/group
#adm:x:4:root,adm,daemon
#lp:x:7:daemon,lp
#uucp:x:14:uucp
#games:x:20:
#dip:x:40:
</pre>

<h1 id="13-禁用没用的服务"><a href="#13-禁用没用的服务" class="headerlink" title="13. 禁用没用的服务"></a>13. 禁用没用的服务</h1><pre>
chkconfig acpid off
chkconfig anacron off
chkconfig auditd off
chkconfig avahi-daemon off
chkconfig autofs off
chkconfig atd off
chkconfig bluetooth off
chkconfig cpuspeed off
chkconfig cups off
chkconfig firstboot off
chkconfig gpm off
chkconfig haldaemon off
chkconfig hidd off
chkconfig ip6tables off
chkconfig iptables off
chkconfig lvm2-monitor off
chkconfig mcstrans off
chkconfig mdmonitor off
chkconfig messagebus off
chkconfig nfslock off
chkconfig pcscd off
chkconfig rawdevices off
chkconfig readahead_early off
chkconfig restorecond off
chkconfig rpcidmapd off
chkconfig sendmail off
chkconfig xfs off
chkconfig yum-updatesd off
chkconfig NetworkManager off
</pre>




  </article>



<div id="disqus_thread"></div>
<script>

var disqus_config = function () {
this.page.url = 'http://kevin0431.github.io/2016/05/15/Centos安全加固总结/index.html';
this.page.identifier = undefined;
};

(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');

s.src = '//yourdisqustoken.disqus.com/embed.js';

s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>



    </div>
  </div>
  <footer class="page-footer"><div class="clearfix">
</div>
<div class="right-foot container">

    <a class="backtop wow fadeIn animated" href="#top" >
        <i class="fa fa-arrow-right"></i>
    </a>
    © Kelvin 2015-2016
    <a href="https://github.com/gaoryrt/hexo-theme-pln">
        Theme Pln
    </a>

</div>
<div class="clearfix">
</div>
</footer>
  <script src="//cdn.bootcss.com/jquery/2.2.1/jquery.min.js"></script>
<script type="text/javascript">

// comments below to disable loading animation
function revealOnScroll() {
  var scrolled = $(window).scrollTop();
  $(".excerpt, .index-title, .index-meta, p").each(function() {
    var current = $(this),
      height = $(window).outerHeight(),
      offsetTop = current.offset().top;
    (scrolled + height + 50 > offsetTop) ? current.addClass("animation"):'';
  });
}
$(window).on("scroll", revealOnScroll);
$(document).ready(revealOnScroll)

// disqus scripts


// dropdown scripts
$(".dropdown").click(function(event) {
  var current = $(this);
  event.stopPropagation();
  $(current).children(".dropdown-content")[($(current).children(".dropdown-content").hasClass("open"))?'removeClass':'addClass']("open")
});
$(document).click(function(){
    $(".dropdown-content").removeClass("open");
})

// back to top scripts
$("a[href='#top']").click(function() {
  $("html, body").animate({ scrollTop: 0 }, 500);
  return false;
});
</script>

</body>
</html>
